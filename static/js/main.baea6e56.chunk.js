(window["webpackJsonpcontinuum-client"]=window["webpackJsonpcontinuum-client"]||[]).push([[0],{58:function(e,t,n){e.exports=n(95)},68:function(e,t,n){},69:function(e,t,n){},92:function(e,t){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),o=n.n(c),i=n(1),s=n(18),l=n(2),u=n(50),f=n(51),m=n(3),p=n.n(m),h=function(){function e(t){var n=this,a=t.bpm,r=t.numSteps;Object(u.a)(this,e),this._loopCallback=function(e){n._onTick(e,n.step);var t=n._nextNotes().map(function(e){return e+10*n.frequencyOffset});t.length>0&&n.synth.triggerAttackRelease(t,"16n",e)},this.addNote=function(e){var t=e.index,a=e.freq,r=n.chords[t];r.includes(a)||r.push(a)},this.removeNote=function(e){var t=e.index,a=e.freq;n.chords[t]=n.chords[t].filter(function(e){return e!==a})},this.triggerAttack=function(e){n.synth.triggerAttack(e)},this.triggerRelease=function(e){n.synth.triggerRelease(e)},this.setAmpAttack=function(e){n.synth.set({envelope:{attack:e+.01}})},this.setAmpDecay=function(e){n.synth.set({envelope:{decay:e+.01}})},this.setAmpSustain=function(e){n.synth.set({envelope:{sustain:e}})},this.setAmpRelease=function(e){n.synth.set({envelope:{release:10*e+.01}})},this.setFilterAttack=function(e){n.synth.set({filterEnvelope:{attack:e/5+.01}})},this.setFilterDecay=function(e){n.synth.set({filterEnvelope:{decay:e+.01}})},this.setFilterSustain=function(e){n.synth.set({filterEnvelope:{sustain:e}})},this.setFilterRelease=function(e){n.synth.set({filterEnvelope:{release:100*e+.01}})},this.setFilterBase=function(e){n.synth.set({filterEnvelope:{baseFrequency:500*e+1}})},this.setFilterRange=function(e){n.synth.set({filterEnvelope:{octaves:20*e}})},this.setFilterQ=function(e){n.synth.set({filter:{Q:10*e}})},this.start=function(){p.a.context.resume(),n.loop.start()},this.stop=function(){n.loop.stop(),n.step=0},p.a.Transport.bpm.value=a,p.a.Transport.start(),this.synth=new p.a.PolySynth(6,p.a.MonoSynth).toMaster(),this.synth.set({oscillator:{type:"sawtooth"}}),this.chords=new Array(r).fill(null).map(function(e){return[]}),this.step=0,this.frequencyOffset=0,this.loop=new p.a.Loop(this._loopCallback,"16n")}return Object(f.a)(e,[{key:"_onTick",value:function(e,t){var n=this;this.onTick&&p.a.Draw.schedule(function(){n.onTick(t)},e+.1)}},{key:"_nextNotes",value:function(){var e=this.chords[this.step]||[];return this.step++,this.step>=this.chords.length&&(this.step=0),e}}]),e}(),y=n(52),v=n(53),b=n.n(v);n(30);function d(){var e=Object(y.a)(["synth1UI.composition.",".",".active"]);return d=function(){return e},e}var g=function(e,t,n){e.subscribe(b()(e.getState,t)(n))};var O=n(7);function k(e){return"black"===e.color}var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127;if(!(e<0||t>127)){var n=new Array(t-e).fill(0).map(function(t,n){return n+e});return n=n.map(function(e){var t=p.a.Frequency(e,"midi"),n=t.toNote();return{name:n,frequency:t.toFrequency(),color:n.includes("#")?"black":"white"}})}console.error("note out of range")}(36,60),j=new Array(24).fill(null).map(function(e,t){return new Array(8).fill(null).map(function(){return{active:!1,note:E[t]}})}),w=Object(O.b)({initialState:{amp:{attack:0,decay:.5,sustain:1,release:.2},filter:{attack:0,decay:.5,sustain:1,release:.2,base:0,range:.5,q:0},composition:j,numNotes:24,numSteps:8,startNote:36,notes:E},reducers:{setAmp:function(e,t){for(var n=0,a=Object.entries(t.payload);n<a.length;n++){var r=a[n],c=Object(i.a)(r,2),o=c[0],s=c[1];e.amp[o]=s}},setFilter:function(e,t){for(var n=0,a=Object.entries(t.payload);n<a.length;n++){var r=a[n],c=Object(i.a)(r,2),o=c[0],s=c[1];e.filter[o]=s}},setCompositionCell:function(e,t){var n=t.payload,a=n.row,r=n.col,c=n.active;e.composition[a][r].active=c}}}),C=w.actions,S=C.setAmp,A=C.setFilter,F=C.setCompositionCell,I=w.reducer,N=n(5),U=Object(a.memo)(function(e){var t=e.value,n=e.onChange,a=e.children;return r.a.createElement("div",{className:"knob"},r.a.createElement(N.CircularInput,{radius:28,value:t,onChange:n},r.a.createElement(N.CircularTrack,{strokeWidth:14}),r.a.createElement(N.CircularProgress,{strokeWidth:14}),r.a.createElement(N.CircularThumb,{r:"8"})),a)}),q={setCompositionCell:F},P=Object(l.b)(null,q)(function(e){var t=e.row,n=e.col,c=e.setCompositionCell,o=Object(l.c)(function(e){return e.synth1UI.composition[t][n]}),i=k(o.note),s=o.active,u=["piano-cell",i?"black":"white",s?"active":"inactive"].join(" "),f=Object(a.useCallback)(function(){c({row:t,col:n,active:!s})},[c,t,n,s]);return r.a.createElement("span",{className:u,onClick:f})}),R=function(e){var t=e.row,n=e.black?"black":"white",a=Object(l.c)(function(e){return e.synth1UI.composition[t]});return r.a.createElement("section",{className:"step-row ".concat(n)},r.a.createElement("div",{className:"steps-row"},a.map(function(e,n){return r.a.createElement(P,{key:"".concat(t,", ").concat(n),row:t,col:n})})))},x=(n(68),{setCompositionCell:F}),D=Object(l.b)(function(e){return{notes:e.synth1UI.notes,composition:e.synth1UI.composition}},x)(function(e){e.setCompositionCell,e.activeColumn;var t=e.notes;return r.a.createElement("div",{className:"piano-roll"},r.a.createElement("section",{className:"piano-roll-keys"},t.map(function(e){var t=["piano-key",k(e)?"black":"white"].join(" ");return r.a.createElement("div",{className:t,key:e.name},r.a.createElement("p",null,e.name))})),r.a.createElement("section",{className:"piano-roll-editor"},t.map(function(e,t){return r.a.createElement(R,{row:t,black:k(e),key:t})})))}),T=new Array(7).fill(null).map(function(e,t){return String(t-3)}),_={setAmp:S,setFilter:A},B=function(e,t){return Object(a.useCallback)(function(n){return e(Object(s.a)({},t,n))},[e,t])},M=Object(l.b)(function(e){return{amp:e.synth1UI.amp,filter:e.synth1UI.filter,numSteps:e.synth1UI.numSteps}},_)(function(e){var t=e.isPlaying,n=e.setAmp,c=e.setFilter,o=e.amp,s=e.filter,u=e.numSteps,f=Object(l.d)(),m=Object(a.useState)("0"),p=Object(i.a)(m,2),y=p[0],v=p[1],b=Object(a.useState)(0),O=Object(i.a)(b,2),k=O[0],E=O[1],j=Object(a.useRef)(new h({bpm:170,numSteps:u}));Object(a.useEffect)(function(){!function(e,t){g(e,"synth1UI.amp.attack",t.setAmpAttack),g(e,"synth1UI.amp.decay",t.setAmpDecay),g(e,"synth1UI.amp.sustain",t.setAmpSustain),g(e,"synth1UI.amp.release",t.setAmpRelease),g(e,"synth1UI.filter.attack",t.setFilterAttack),g(e,"synth1UI.filter.decay",t.setFilterDecay),g(e,"synth1UI.filter.sustain",t.setFilterSustain),g(e,"synth1UI.filter.release",t.setFilterRelease),g(e,"synth1UI.filter.base",t.setFilterBase),g(e,"synth1UI.filter.range",t.setFilterRange),g(e,"synth1UI.filter.q",t.setFilterQ);var n=e.getState().synth1UI.composition,a=!0,r=!1,c=void 0;try{for(var o,s=n.entries()[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value,u=Object(i.a)(l,2),f=u[0],m=u[1],p=!0,h=!1,y=void 0;try{for(var v,b=function(){var n=v.value,a=(k=Object(i.a)(n,2))[0],r=k[1],c=String.raw(d(),f,a);g(e,c,function(e){console.log("".concat(r.note.name," changed to ").concat(e)),e?t.addNote({index:a,freq:r.note.frequency}):t.removeNote({index:a,freq:r.note.frequency})})},O=m.entries()[Symbol.iterator]();!(p=(v=O.next()).done);p=!0){var k;b()}}catch(E){h=!0,y=E}finally{try{p||null==O.return||O.return()}finally{if(h)throw y}}}}catch(E){r=!0,c=E}finally{try{a||null==s.return||s.return()}finally{if(r)throw c}}}(f,j.current),j.current.onTick=function(e){E(e)}},[f]),Object(a.useEffect)(function(){j.current&&(t?j.current.start():j.current.stop())},[t,j]);var w=function(e){j.current.frequencyOffset=Number(e.currentTarget.value),v(e.currentTarget.value)};return r.a.createElement("div",{className:"App"},r.a.createElement("section",{id:"amp-env"},r.a.createElement("h2",null,"Amp Env"),r.a.createElement("div",{className:"knob-row"},r.a.createElement(U,{value:o.attack,onChange:B(n,"attack")},"Attack"),r.a.createElement(U,{value:o.decay,onChange:B(n,"decay")},"Decay"),r.a.createElement(U,{value:o.sustain,onChange:B(n,"sustain")},"Sustain"),r.a.createElement(U,{value:o.release,onChange:B(n,"release")},"Release"))),r.a.createElement("section",{id:"filter-env"},r.a.createElement("h2",null,"Filter"),r.a.createElement("div",{className:"knob-row"},r.a.createElement(U,{value:s.attack,onChange:B(c,"attack")},"Attack"),r.a.createElement(U,{value:s.decay,onChange:B(c,"decay")},"Decay"),r.a.createElement(U,{value:s.sustain,onChange:B(c,"sustain")},"Sustain"),r.a.createElement(U,{value:s.release,onChange:B(c,"release")},"Release"),r.a.createElement(U,{value:s.base,onChange:B(c,"base")},"Base"),r.a.createElement(U,{value:s.range,onChange:B(c,"range")},"Range"),r.a.createElement(U,{value:s.q,onChange:B(c,"q")},"Q"))),r.a.createElement("form",{id:"frequency-offset"},r.a.createElement("h3",null,"Frequency Offset"),r.a.createElement("div",null,T.map(function(e){return r.a.createElement("input",{type:"radio",name:"frequency-offset",value:e,key:e,checked:y===e,onChange:w})}))),r.a.createElement(D,{currentStep:k}))}),Q=n(55),W=n.n(Q),J=(n(69),n(28)),H=Object(O.b)({initialState:{message:"Hello, World"},reducers:{setMessage:function(e,t){console.log("change to ",t.payload),e.message=t.payload}}}),L=(H.actions.setMessage,H.reducer),z=function(e){return e=e||[],Object(O.a)({reducer:{synth1UI:I,util:L},middleware:[].concat(Object(J.a)(Object(O.c)()),Object(J.a)(e))})},G=n(56),K=n.n(G);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var X=function(){var e=K()("http://localhost:4000",{transports:["websocket"]});return[function(t){return function(t){return function(n){var a=t(n);return n.origin||e.emit("action",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach(function(t){Object(s.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{origin:e.id})),a}}},function(t){e.on("action",function(e){t.dispatch(e)})}]}(),Y=Object(i.a)(X,2),Z=Y[0],$=Y[1],ee=z([Z]);$(ee);var te=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),s=Object(i.a)(o,2),u=s[0],f=s[1];return Object(a.useEffect)(function(){W()(p.a.context).then(function(){f(!0)})},[]),u?r.a.createElement(l.a,{store:ee},r.a.createElement("button",{id:"play-button",onClick:function(){return c(!n)}},n?"Stop":"Play"),r.a.createElement(M,{isPlaying:n})):"Click"};o.a.render(r.a.createElement(te,null),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.baea6e56.chunk.js.map