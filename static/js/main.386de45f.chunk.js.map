{"version":3,"sources":["util/notes-util.js","redux/config-creators/compositionReducerConfig.js","BassSynth/bassReducer.js","components/util/DialIndicator.jsx","components/util/Dial.jsx","BassSynth/BassSynth.jsx","redux/reducers/synth1Reducer.js","LennySynth/lennyReducer.js","components/piano-roll/Cell.jsx","components/piano-roll/PianoRoll.jsx","Drummer/drummerReducer.js","components/piano-roll/DrumCell.jsx","components/piano-roll/DrumSequencer.jsx","LennySynth/LennySynth.jsx","Drummer/Drummer.jsx","components/App.jsx","audio/CSynth.js","BassSynth/BassSynthAudio.js","redux/subscriptions.js","redux/reducers/utilReducer.js","redux/reducers/characterReducer.js","redux/store.js","socket/configureSocket.js","audio/Sequence.js","audio/Sequencer.js","util/util.js","LennySynth/LennySynthAudio.js","Drummer/DrummerAudio.js","index.js","audio-files/kicks/kick_02.wav","audio-files/snares/snare_01.wav","audio-files/rims/rim_01.wav","audio-files/shaker_snaps/shaker_snap_01.wav","audio-files/claps/clap_01.wav","audio-files/short_cymbals/short_cymbal_01.wav","audio-files/long_cymbals/long_cymbal_01.wav"],"names":["midiToNote","noteNumber","freq","Tone","Frequency","name","toNote","frequency","toFrequency","color","includes","midi","octaveNotes","notes","scale","map","toMidi","createCompositionSliceConfig","initialState","composition","range","i","active","note","keyIndex","reducers","setCompositionCell","state","action","payload","row","col","transpose","semitones","cell","compositionReducerConfig","bassSlice","createSlice","slice","length","shape","filter","decay","q","setLength","setShape","setFilterDecay","setFilterRange","setFilterQ","actions","DialIndicator","strokeWidth","stroke","useCircularInputContext","getPointFromValue","center","x","y","ref","useRef","useCircularDrag","x1","y1","x2","y2","cx","cy","r","opacity","memo","value","onChange","children","disabled","handleChange","useCallback","throttle","v","char","useSelector","character","textColor","mainColor","className","radius","strokeLinecap","style","transition","zIndex","mapDispatch","connect","bass","filterDecay","filterRange","filterQ","currentCharacter","synth1Slice","amp","attack","sustain","release","base","setAmp","Object","entries","key","setFilter","lennySlice","reverb","phaser","vibratoDepth","setReverb","setPhaser","setVibratoDepth","setActions","synth1","set1","setBass","lenny","setLenny","playing","dispatch","useDispatch","maxReached","util","cells","handleClick","e","stopPropagation","Boolean","onClick","_","cn","PianoRoll","currentStep","n","rowNum","colNum","files","kick","snare","rim","shakerSnap","clap","shortCymbal","longCymbal","path","match","index","String","compositionSliceConfig","drummerSlice","filterFreq","delay","setFilterFreq","setDelay","drummer","setDrummer","isDrummer","DrumSequencer","drumFiles","DrumCell","mapDispatchToProps","type","checked","target","numActive","countDown","useState","setCurrentStep","setTonic","setScale","useEffect","sequencer","onTick","step","nameColor","id","CSynth","triggerAttack","synth","triggerRelease","triggerAttackRelease","time","setAmpAttack","ratio","set","envelope","setAmpDecay","setAmpSustain","setAmpRelease","setFilterAttack","filterEnvelope","setFilterSustain","setFilterRelease","setFilterBase","baseFrequency","octaves","Q","Error","this","PolySynth","MonoSynth","chain","Limiter","Master","volume","oscillator","BassSynthAudio","detune","subscribe","store","callback","watch","getState","get","subscribeCSynth","synthName","subscribeBassSynth","subscribeLennySynth","subscribeDrummer","subscribeSequencer","sequence","rowi","coli","raw","addNote","removeNote","sequences","setNumActive","utilSlice","message","startTime","nextInterval","setMessage","console","log","setStartTime","setNextInterval","setCountDown","extraReducers","characterSlice","setCharacter","makeStore","middleware","configureStore","reducer","synth1Reducer","bassReducer","lennyReducer","drummerReducer","utilReducer","characterReducer","getDefaultMiddleware","preloadedState","blackList","charOverride","process","REACT_APP_CHAR","makeActionEmitter","socket","next","result","origin","emit","makeStoreWithSocket","a","io","transports","Promise","resolve","on","config","actionEmitter","cb","charactersById","count","setTimeout","Sequence","numSteps","chords","frequencyOffset","chord","push","Array","fill","Sequencer","bpm","loop","_loopCallback","_onTick","values","seq","nextChord","getNotes","createSequence","start","context","resume","stop","Transport","Loop","humanize","onLoop","Draw","schedule","Date","now","mapRatioToRange","out_min","out_max","LennySynthAudio","in_min","roomSize","wet","vibrato","depth","Freeverb","Vibrato","Phaser","stages","DrummerAudio","forEach","urls","restart","Math","pow","feedback","clamp","reduce","acc","file","Filter","FeedbackDelay","Players","Volume","document","getElementById","innerHTML","startAudioContext","ReactDOM","render","module","exports"],"mappings":"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","file":"static/js/main.386de45f.chunk.js","sourcesContent":["import Tone from 'tone';\n\n/**\n * https://pages.mtu.edu/~suits/west_scales.html\n * https://www.musicnotes.com/now/tips/circle-of-fifths-guide/\n * https://github.com/tonaljs/tonal/blob/master/packages/scale-dictionary/data.ts\n */\n\n// helper functions\nexport function isBlack(note) {\n  return note.color === 'black';\n}\n\nexport function isWhite(note) {\n  return note.color === 'white'\n}\n\nexport function generateNotes(startNote = 0, endNote = 127) {\n  if (startNote < 0 || endNote > 127) {\n    console.error('note out of range');\n    return;\n  }\n\n  let notes = new Array(endNote - startNote).fill(0).map((_, i) => i + startNote);\n  notes = notes.map(midiToNote);\n  return notes;\n}\n\nexport const midiToNote = noteNumber => {\n  const freq = Tone.Frequency(noteNumber, 'midi');\n  const name = freq.toNote();\n  return {\n    name,\n    frequency: freq.toFrequency(),\n    color: name.includes('#') ? 'black' : 'white',\n    midi: noteNumber\n  }\n}\n\nexport const nameToNote = name => {\n  const freq = Tone.Frequency(name, 'note');\n  return {\n    name,\n    frequency: freq.toFrequency(),\n    color: name.includes('#') ? 'black' : 'white',\n    midi: freq.toMidi()\n  }\n}\n\nexport const octaveNotes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n","import { midiToNote, nameToNote } from '../../util/notes-util';\nimport { scale } from '@tonaljs/scale';\nimport { range } from 'lodash';\n\nexport const numNotes = 14;\nexport const numSteps = 16;\nexport const startNote = 36;\n// export const notes = generateNotes(startNote, startNote + numNotes);\n\nexport const notes = [...scale('E3 minor').notes, ...scale('E4 minor').notes].map(nameToNote);\n\nexport const createCompositionSliceConfig = () => ({\n  initialState: {\n    composition: range(numNotes)\n      .map(i =>\n        range(numSteps)\n          .map(() => ({\n            active: false,\n            note: notes[i],\n            keyIndex: i\n          }))\n      ),\n  },\n  reducers: {\n    setCompositionCell(state, action) {\n      const { row, col, active } = action.payload;\n      state.composition[row][col].active = active;\n    },\n    transpose(state, action) {\n      const { semitones } = action.payload;\n      state.composition = state.composition\n        .map(row => row.map(cell => midiToNote(cell.midi + semitones)));\n    }\n  }\n});","import { createSlice } from 'redux-starter-kit';\nimport { createCompositionSliceConfig } from '../redux/config-creators/compositionReducerConfig';\n\nconst compositionReducerConfig = createCompositionSliceConfig();\n\nconst bassSlice = createSlice({\n  slice: 'bass',\n  initialState: {\n    length: 0.07,\n    shape: 0,\n    filter: {\n      decay: 0.5,\n      range: 0.3769,\n      q: 0.1,\n    },\n    ...compositionReducerConfig.initialState\n  },\n  reducers: {\n    ...compositionReducerConfig.reducers,\n    setLength(state, action) {\n      state.length = action.payload;\n    },\n    setShape(state, action) {\n      state.shape = action.payload;\n    },\n    setFilterDecay(state, action) {\n      state.filter.decay = action.payload;\n    },\n    setFilterRange(state, action) {\n      state.filter.range = action.payload;\n    },\n    setFilterQ(state, action) {\n      state.filter.q = action.payload;\n    },\n  }\n});\n\nexport const {\n  setCompositionCell,\n  setLength,\n  setShape,\n  setFilterDecay,\n  setFilterRange,\n  setFilterQ,\n} = bassSlice.actions;\nexport default bassSlice.reducer;","import React, { useRef } from 'react';\nimport {\n  useCircularInputContext,\n  useCircularDrag\n} from 'react-circular-input'\n\nconst DialIndicator = ({strokeWidth, stroke}) => {\n  const { getPointFromValue, center } = useCircularInputContext()\n  const { x, y,  } = getPointFromValue()\n\n  const ref = useRef(null)\n  useCircularDrag(ref)\n\n  return <g>\n    <line x1={center.x} y1={center.y} x2={x} y2={y} stroke={stroke} strokeWidth={strokeWidth}/>\n    {/* <line x1={center.x} y1={center.y} x2={x} y2={y} stroke='white' strokeOpacity={0} strokeWidth={6}/> */}\n    <circle ref={ref} cx={x} cy={y} r={20} stroke='white' opacity={0}/>\n  </g> \n\n}\n\nexport default DialIndicator;","import React, { memo, useCallback } from 'react';\nimport { throttle } from 'lodash';\nimport { useSelector } from 'react-redux';\n\nimport {\n  CircularInput,\n  CircularTrack,\n  CircularProgress,\n} from 'react-circular-input';\nimport DialIndicator from './DialIndicator';\n\nconst Dial = ({ value, onChange, children, disabled }) => {\n\n  const handleChange = useCallback(throttle(v => {\n    onChange(v)\n  }, 100), [onChange])\n\n  const char = useSelector(state => state.character.character);\n  const textColor = disabled ? 'lightgray' : 'black'\n  const mainColor = disabled ? 'lightgray' : `var(--${char}Color)`\n\n  return (\n    <div className='knob'>\n      <div>\n        <CircularInput radius={21}\n          value={value}\n          onChange={disabled ? () => { } : handleChange}>\n          <CircularTrack stroke='lightgray' strokeWidth={1} strokeLinecap='square' />\n          <CircularProgress style={{transition: 'stroke 1s'}} stroke={mainColor} strokeWidth={2} strokeLinecap='square' />\n          <DialIndicator strokeWidth={2} stroke={mainColor} />\n        </CircularInput>\n      </div>\n      <div style={{ color: textColor, zIndex: -1 }}>{children}</div>\n    </div>\n  );\n}\n\nexport default memo(Dial);","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  setCompositionCell,\n  setLength,\n  setShape,\n  setFilterDecay,\n  setFilterRange,\n  setFilterQ\n} from './bassReducer';\nimport Dial from '../components/util/Dial';\n\nconst mapDispatch = {\n  setCompositionCell,\n  setLength,\n  setShape,\n  setFilterDecay,\n  setFilterRange,\n  setFilterQ\n};\n\nconst mapStateToProps = state => ({\n  length: state.bass.length,\n  shape: state.bass.shape,\n  filterDecay: state.bass.filter.decay,\n  filterRange: state.bass.filter.range,\n  filterQ: state.bass.filter.q,\n  currentCharacter: state.character.character\n});\n\nconst BassSynth = ({\n  setLength,\n  setShape,\n  setFilterDecay,\n  setFilterRange,\n  setFilterQ,\n  length,\n  shape,\n  filterDecay,\n  filterRange,\n  filterQ,\n  currentCharacter\n}) => {\n\n  const disabled = currentCharacter !== 'bass';\n  // actual render code\n  return (\n    <div className={`bass-synth synth ${disabled ? '' : 'current'} `}>\n      <div className='knob-row'>\n        <Dial\n          disabled={disabled}\n          value={length}\n          onChange={setLength} >\n          Length\n        </Dial>\n        <Dial\n          disabled={disabled}\n          value={shape}\n          onChange={setShape} >\n          Shape\n        </Dial>\n        <Dial\n          disabled={disabled}\n          value={filterDecay}\n          onChange={setFilterDecay} >\n          Decay\n        </Dial>\n        <Dial\n          disabled={disabled}\n          value={filterRange}\n          onChange={setFilterRange} >\n          Brightness\n        </Dial>\n        <Dial\n          disabled={disabled}\n          value={filterQ}\n          onChange={setFilterQ} >\n          Harshness\n        </Dial>\n      </div>\n    </div >\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatch\n)(BassSynth);\n","import { createSlice } from 'redux-starter-kit';\nimport { createCompositionSliceConfig } from '../config-creators/compositionReducerConfig';\n\nconst compositionReducerConfig = createCompositionSliceConfig();\n\nconst synth1Slice = createSlice({\n  slice: 'synth1',\n  initialState: {\n    amp: {\n      attack: 0,\n      decay: 0.5,\n      sustain: 1,\n      release: 0.2\n    },\n    filter: {\n      attack: 0,\n      decay: 0.5,\n      sustain: 1,\n      release: 0.2,\n      base: 0,\n      range: 0.5,\n      q: 0,\n    },\n    ...compositionReducerConfig.initialState\n  },\n  reducers: {\n    setAmp(state, action) {\n      // allow for setting arbitrary values\n      for (let [key, value] of Object.entries(action.payload)) {\n        state.amp[key] = value;\n      }\n    },\n    setFilter(state, action) {\n      // allow for setting arbitrary values\n      for (let [key, value] of Object.entries(action.payload)) {\n        state.filter[key] = value;\n      }\n    },\n    ...compositionReducerConfig.reducers\n  }\n});\n\nexport const { setAmp, setFilter, setCompositionCell } = synth1Slice.actions;\nexport default synth1Slice.reducer;","import { createSlice } from 'redux-starter-kit';\nimport { createCompositionSliceConfig } from '../redux/config-creators/compositionReducerConfig';\n\nconst compositionReducerConfig = createCompositionSliceConfig();\n\nconst lennySlice = createSlice({\n  slice: 'lenny',\n  initialState: {\n    reverb: 0,\n    length: 0.25,\n    phaser: false,\n    vibratoDepth: 0.1,\n    ...compositionReducerConfig.initialState\n  },\n  reducers: {\n    ...compositionReducerConfig.reducers,\n    setReverb(state, action) {\n      state.reverb = action.payload;\n    },\n    setLength(state, action) {\n      state.length = action.payload;\n    },\n    setPhaser(state, action) {\n      state.phaser = action.payload; \n    },\n    setVibratoDepth(state, action) {\n      state.vibratoDepth = action.payload;\n    }\n  }\n});\n\nexport const {\n  setCompositionCell,\n  setReverb,\n  setLength,\n  setPhaser,\n  setVibratoDepth\n} = lennySlice.actions\nexport default lennySlice.reducer;\n\n","import React, { useCallback, memo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setCompositionCell as set1 } from '../../redux/reducers/synth1Reducer';\nimport { setCompositionCell as setBass } from '../../BassSynth/bassReducer';\nimport { setCompositionCell as setLenny } from '../../LennySynth/lennyReducer';\nimport _ from 'lodash'\nimport './cell.css';\n\nconst setActions = {\n  synth1: set1,\n  bass: setBass,\n  lenny: setLenny,\n};\n\nconst Cell = ({ row, col, playing }) => {\n  const dispatch = useDispatch();\n\n  const currentCharacter = useSelector(state => state.character.character);\n  const maxReached = useSelector(state => state.util.maxReached);\n\n  const cells = {\n    synth1: useSelector(state => state.synth1.composition[row][col]),\n    bass: useSelector(state => state.bass.composition[row][col]),\n    lenny: useSelector(state => state.lenny.composition[row][col]),\n  };\n\n  const handleClick = useCallback((e) => {\n    e.stopPropagation();\n    if (Boolean(setActions[currentCharacter])) {\n      const active = !cells[currentCharacter].active;\n      if (active && maxReached) return;\n      dispatch(setActions[currentCharacter]({ row, col, active }));\n    }\n  }, [row, col, currentCharacter, dispatch, cells, maxReached]);\n\n  // const className = currentCharacter in cells ? 'piano-cell clickable' : 'piano-cell';\n  let className = 'piano-cell';\n  (currentCharacter in cells) && (className += ' clickable')\n  playing && (className += ' playing')\n\n  return (\n    <span className={className} onClick={handleClick} >\n      {\n        _.map(cells, (cell, character) => {\n          if (!cell.active) return;\n          const cn = 'cell-trigger ' +\n            `cell-trigger-${character} ` +\n            `${playing ? 'playing' : ''} ` +\n            `${currentCharacter === character ? 'current' : ''} `\n          return <span\n            key={character}\n            onClick={handleClick}\n            className={cn}\n          />\n        })\n      }\n    </span>\n  );\n}\n\nexport default memo(Cell);","import React from 'react';\nimport {useSelector} from 'react-redux';\nimport Cell from './Cell';\nimport { notes, numSteps } from '../../redux/config-creators/compositionReducerConfig';\nimport { range } from 'lodash';\nimport './piano-roll.css';\n\nconst PianoRoll = ({ currentStep }) => {\n  const currentCharacter = useSelector(state => state.character.character);\n  return (\n    <div className={`piano-roll ${currentCharacter}`}>\n      <section className='piano-roll-editor'>\n        {\n          notes.map((n, rowNum) =>\n            <section key={n.name} className={'step-row'}>\n              {\n                range(numSteps).map(colNum =>\n                  <Cell key={colNum} row={rowNum} col={colNum} playing={currentStep === colNum} />\n                )\n              }\n            </section>\n          )\n        }\n      </section>\n    </div>\n  );\n}\n\nexport default PianoRoll;\n","import { createSlice } from 'redux-starter-kit';\nimport { createCompositionSliceConfig } from '../redux/config-creators/compositionReducerConfig';\n\nimport kick from '../audio-files/kicks/kick_02.wav';\nimport snare from '../audio-files/snares/snare_01.wav'\nimport rim from '../audio-files/rims/rim_01.wav';\nimport shakerSnap from '../audio-files/shaker_snaps/shaker_snap_01.wav';\nimport clap from '../audio-files/claps/clap_01.wav';\nimport shortCymbal from '../audio-files/short_cymbals/short_cymbal_01.wav';\nimport longCymbal from '../audio-files/long_cymbals/long_cymbal_01.wav';\n\nconst files = [kick, snare, rim, shakerSnap, clap, shortCymbal, longCymbal]\n  .map((path, i) => ({\n    path,\n    name: path.match(/\\w*_\\d\\d(?=\\.)/)[0] || 'default',\n    index: String(i)\n  }));\n\n// const kicksContext = require.context('../audio-files/kicks/', true, /01\\.wav$/);\n// const snaresContext = require.context('../audio-files/snares', true, /01\\.wav$/);\n// const rimsContext = require.context('../audio-files/rims', true, /01\\.wav$/);\n// const shakerSnapsContext = require.context('../audio-files/shaker_snaps', true, /01\\.wav$/);\n// const clapsContext = require.context('../audio-files/claps', true, /01\\.wav$/);\n// const shortCymbalsContext = require.context('../audio-files/short_cymbals', true, /01\\.wav$/);\n// const longCymbalsContext = require.context('../audio-files/long_cymbals', true, /01\\.wav$/);\n\n// resolve file paths\n// for (let [key, context] of Object.entries(files)) {\n//   files[key] = context.keys().map(k => {\n//     const file = context(k)\n//     const name = file.match(/\\w*_\\d\\d(?=\\.)/)[0] || 'default';\n//     return { file, name };\n//   });\n// }\n\nconst compositionSliceConfig = createCompositionSliceConfig();\n\nconst drummerSlice = createSlice({\n  slice: 'drummer',\n  initialState: {\n    files,\n    filterFreq: 1,\n    delay: 0.1,\n    ...compositionSliceConfig.initialState\n  },\n  reducers: {\n    ...compositionSliceConfig.reducers,\n    setFilterFreq(state, action) {\n      state.filterFreq = action.payload;\n    },\n    setDelay(state, action) {\n      state.delay = action.payload\n    }\n  }\n});\n\nexport const {\n  setCompositionCell,\n  setFilterFreq,\n  setDelay\n} = drummerSlice.actions;\nexport default drummerSlice.reducer;","import React, { useCallback, memo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setCompositionCell as setDrummer } from '../../Drummer/drummerReducer';\nimport './cell.css';\n\n\nconst Cell = ({ row, col, playing }) => {\n  const dispatch = useDispatch();\n  const currentCharacter = useSelector(state => state.character.character);\n  const cell = useSelector(state => state.drummer.composition[row][col]);\n  const maxReached = useSelector(state => state.util.maxReached);\n\n  const handleClick = useCallback(e => {\n    e.stopPropagation();\n    if (currentCharacter === 'drummer') {\n      const active = !cell.active;\n      if (active && maxReached) return;\n      dispatch(setDrummer({ row, col, active }));\n    }\n  }, [row, col, dispatch, currentCharacter, cell, maxReached]);\n\n  const isDrummer = currentCharacter === 'drummer';\n  let className = 'piano-cell';\n  isDrummer && (className += ' clickable')\n  playing && (className += ' playing')\n\n  return (\n    <span className={className} onClick={handleClick} >\n      {\n        cell.active &&\n        <span\n          onClick={handleClick}\n          className={\n            'cell-trigger cell-trigger-drummer ' +\n            `${playing ? 'playing' : ''} ` +\n            `${isDrummer ? 'current' : ''}`\n          }\n        />\n      }\n    </span>\n  );\n}\n\nexport default memo(Cell);","import React from 'react';\nimport { numSteps } from '../../redux/config-creators/compositionReducerConfig';\nimport { range } from 'lodash';\nimport { useSelector } from 'react-redux';\nimport './piano-roll.css';\nimport DrumCell from './DrumCell';\n\nconst DrumSequencer = ({ currentStep }) => {\n  const drumFiles = useSelector(state => state.drummer.files);\n  const currentCharacter = useSelector(state => state.character.character);\n\n  return (\n    <div className={`piano-roll drum-sequencer ${currentCharacter === 'drummer' ? 'drummer' : ''}`}>\n      {/* <div className='piano-roll-keys'>\n        {drumFiles.map((file, i) =>\n          <div\n            className='piano-key'\n            key={file.name}>\n            <p>{drumFiles[i].name}</p>\n          </div>\n        )}\n      </div> */}\n      <section className='piano-roll-editor'>\n        {\n          drumFiles.map((n, rowNum) =>\n            <section key={n.name} className={'step-row'}>\n              {\n                range(numSteps).map(colNum =>\n                  <DrumCell key={colNum} row={rowNum} col={colNum} playing={currentStep === colNum} />\n                )\n              }\n            </section>\n          )\n        }\n      </section>\n    </div>\n  );\n}\n\nexport default DrumSequencer;\n","import React, { useCallback } from 'react';\nimport { connect } from 'react-redux';\nimport Dial from '../components/util/Dial.jsx';\nimport {\n  setReverb,\n  setLength,\n  setPhaser,\n  setVibratoDepth\n} from './lennyReducer';\n\nconst mapStateToProps = state => ({\n  reverb: state.lenny.reverb,\n  length: state.lenny.length,\n  phaser: state.lenny.phaser,\n  vibratoDepth: state.lenny.vibratoDepth,\n  currentCharacter: state.character.character\n});\n\nconst mapDispatchToProps = {\n  setReverb,\n  setLength,\n  setPhaser,\n  setVibratoDepth\n};\n\nconst LennySynth = ({\n  reverb,\n  setReverb,\n  length,\n  setLength,\n  phaser,\n  setPhaser,\n  vibratoDepth,\n  setVibratoDepth,\n  currentCharacter\n}) => {\n  const disabled = currentCharacter !== 'lenny';\n  return (\n    <div className={`lenny-synth synth ${disabled ? '' : 'current'} `}>\n      <div className='knob-row knob-row-vertical'>\n        <Dial\n          disabled={disabled}\n          value={length}\n          onChange={setLength} >\n          Length\n        </Dial>\n        <Dial\n          disabled={disabled}\n          value={reverb}\n          onChange={setReverb} >\n          Space\n        </Dial>\n        <input type='checkbox' checked={phaser} onChange={useCallback(e => setPhaser(e.target.checked), [setPhaser])} />\n        <Dial\n          disabled={disabled}\n          value={vibratoDepth}\n          onChange={setVibratoDepth} >\n          Wiggle\n          </Dial>\n      </div>\n    </div>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LennySynth);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { setFilterFreq, setDelay } from './drummerReducer';\nimport Dial from '../components/util/Dial.jsx';\n\nconst mapStateToProps = state => ({\n  filterFreq: state.drummer.filterFreq,\n  delay: state.drummer.delay,\n  currentCharacter: state.character.character\n});\n\nconst mapDispatchToProps = {\n  setFilterFreq,\n  setDelay\n}\n\nconst Drummer = ({\n  filterFreq,\n  setFilterFreq,\n  delay,\n  setDelay,\n  currentCharacter\n}) => {\n  const disabled = currentCharacter !== 'drummer';\n  return (\n    <div className={`drummer-synth synth ${disabled ? '' : 'current'} `}>\n      <div className='knob-row knob-row-horizontal'>\n        <Dial\n          value={filterFreq}\n          onChange={setFilterFreq}\n          disabled={disabled}>\n          Brightness\n        </Dial>\n        <Dial\n          value={delay}\n          onChange={setDelay}\n          disabled={disabled}>\n          Delay\n        </Dial>\n      </div>\n    </div>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Drummer);","import React, { useState, useEffect, useCallback } from 'react';\nimport BassSynth from '../BassSynth/BassSynth.jsx';\nimport PianoRoll from './piano-roll/PianoRoll.jsx';\nimport './App.css';\nimport { octaveNotes } from '../util/notes-util';\nimport { sequencer } from '../index';\nimport { connect } from 'react-redux';\nimport DrumSequencer from './piano-roll/DrumSequencer.jsx';\nimport LennySynth from '../LennySynth/LennySynth';\nimport Drummer from '../Drummer/Drummer';\n\nconst mapStateToProps = state => ({\n  numActive: state.util.numActive,\n  maxReached: state.util.maxReached,\n  countDown: state.util.countDown\n});\n\nconst App = ({ numActive, maxReached, countDown }) => {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [tonic, setTonic] = useState(octaveNotes[0]);\n  const [scale, setScale] = useState('major');\n\n  const handleTonicChange = useCallback(e => {\n    setTonic(e.target.value);\n  }, [setTonic]);\n\n  const handleScaleChange = useCallback(e => {\n    setScale(e.target.value);\n  }, [setScale]);\n\n  // runs once after first render\n  useEffect(() => {\n    // callback for sequencer\n    sequencer.onTick = step => {\n      setCurrentStep(step);\n    }\n  }, []);\n\n  const nameColor = maxReached ? 'red' : 'black';\n\n  return (\n    <main>\n      <section id='control-panel'>\n        <h1 style={{color: nameColor}}>Continuum</h1>\n        <h1 id='count-down'>{countDown}</h1>\n      </section>\n      <BassSynth />\n      <LennySynth />\n      <Drummer />\n      <section id='sequencer'>\n        <PianoRoll currentStep={currentStep} />\n        <DrumSequencer currentStep={currentStep} />\n      </section>\n    </main>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  null,\n)(App);","import Tone from 'tone';\n\nexport default class CSynth {\n  name = null;\n  constructor(name) {\n    if (!name) {\n      throw new Error('CSynth constructor requires a name');\n    }\n    this.name = name;\n    this.synth = new Tone.PolySynth(6, Tone.MonoSynth)\n      .chain(\n        new Tone.Limiter(),\n        Tone.Master\n      );\n    this.synth.set({\n      volume: -12,\n      oscillator: {\n        type: 'sawtooth'\n      },\n    });\n  }\n\n  triggerAttack = (frequency) => {\n    this.synth.triggerAttack(frequency);\n  }\n\n  triggerRelease = (frequency) => {\n    this.synth.triggerRelease(frequency);\n  }\n\n  triggerAttackRelease = (notes, length, time) => {\n    this.synth.triggerAttackRelease(notes, length, time);\n  }\n\n  setAmpAttack = (ratio) => {\n    this.synth.set({\n      envelope: {\n        attack: ratio + 0.01\n      }\n    });\n  }\n\n  setAmpDecay = (ratio) => {\n    this.synth.set({\n      envelope: {\n        decay: ratio + 0.01\n      }\n    });\n  }\n\n  setAmpSustain = (ratio) => {\n    this.synth.set({\n      envelope: {\n        sustain: ratio\n      }\n    });\n  }\n\n  setAmpRelease = (ratio) => {\n    this.synth.set({\n      envelope: {\n        release: (ratio * 10) + 0.01\n      }\n    });\n  }\n\n  setFilterAttack = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        attack: (ratio / 5) + 0.01\n      }\n    });\n  }\n\n  setFilterDecay = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        decay: ratio + 0.01\n      }\n    });\n  }\n\n  setFilterSustain = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        sustain: ratio\n      }\n    });\n  }\n\n  setFilterRelease = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        release: (ratio * 100) + 0.01\n      }\n    });\n  }\n\n  setFilterBase = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        baseFrequency: (ratio * 500) + 1\n      }\n    });\n  }\n\n  setFilterRange = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        octaves: ratio * 20\n      }\n    });\n  }\n\n  setFilterQ = (ratio) => {\n    this.synth.set({\n      filter: {\n        Q: ratio * 10\n      }\n    })\n  }\n}","import Tone from 'tone';\n\nexport default class BassSynthAudio {\n  name = null;\n  constructor(name) {\n    if (!name) {\n      throw new Error('CSynth constructor requires a name');\n    }\n    this.name = name;\n    this.synth = new Tone.PolySynth(1, Tone.MonoSynth)\n      .chain(\n        new Tone.Limiter(),\n        Tone.Master\n      );\n    this.synth.set({\n      volume: -12,\n      detune: -3200,\n      oscillator: {\n        type: 'sawtooth'\n      },\n      envelope: {\n        attack: 0.01,\n        sustain: 1,\n        decay: 0.05\n      },\n      filter: {\n        baseFrequency: 6,\n      },\n      filterEnvelope: {\n        sustain: 0.47415415352178325,\n      }\n    });\n  }\n\n  triggerAttack = (frequency) => {\n    this.synth.triggerAttack(frequency);\n  }\n\n  triggerRelease = (frequency) => {\n    this.synth.triggerRelease(frequency);\n  }\n\n  triggerAttackRelease = (notes, length, time) => {\n    this.synth.triggerAttackRelease(notes, length, time);\n  }\n\n  setLength = ratio => {\n    this.synth.set({\n      envelope: {\n        release: (ratio * 10) + 0.01\n      },\n      filterEnvelope: {\n        release: (ratio * 100) + 0.01\n      }\n    })\n  }\n\n  setShape = ratio => {\n    this.synth.set({\n      filterEnvelope: {\n        attack: (ratio / 5) + 0.01\n      }\n    });\n  }\n\n  setFilterDecay = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        decay: ratio + 0.01\n      }\n    });\n  }\n\n  setFilterRange = (ratio) => {\n    this.synth.set({\n      filterEnvelope: {\n        octaves: ratio * 20\n      }\n    });\n  }\n\n  setFilterQ = (ratio) => {\n    this.synth.set({\n      filter: {\n        Q: ratio * 10\n      }\n    })\n  }\n}","// import store from './store';\nimport watch from 'redux-watch';\nimport { get } from 'object-path';\n\n// use redux-watch to subscribe to a certain store value\n// and use the callback to set the initial value\nconst subscribe = (store, path, callback) => {\n  store.subscribe(watch(store.getState, path)(callback));\n  callback(get(store.getState(), path));\n}\n\nexport function subscribeCSynth(store, synth) {\n  const synthName = synth.name;\n  subscribe(store, `${synthName}.amp.attack`, synth.setAmpAttack);\n  subscribe(store, `${synthName}.amp.decay`, synth.setAmpDecay);\n  subscribe(store, `${synthName}.amp.sustain`, synth.setAmpSustain);\n  subscribe(store, `${synthName}.amp.release`, synth.setAmpRelease);\n\n  subscribe(store, `${synthName}.filter.attack`, synth.setFilterAttack);\n  subscribe(store, `${synthName}.filter.decay`, synth.setFilterDecay);\n  subscribe(store, `${synthName}.filter.sustain`, synth.setFilterSustain);\n  subscribe(store, `${synthName}.filter.release`, synth.setFilterRelease);\n  subscribe(store, `${synthName}.filter.base`, synth.setFilterBase);\n  subscribe(store, `${synthName}.filter.range`, synth.setFilterRange);\n  subscribe(store, `${synthName}.filter.q`, synth.setFilterQ);\n}\n\nexport function subscribeBassSynth(store, synth) {\n  const synthName = synth.name;\n  subscribe(store, `${synthName}.length`, synth.setLength)\n  subscribe(store, `${synthName}.shape`, synth.setShape);\n  subscribe(store, `${synthName}.filter.decay`, synth.setFilterDecay);\n  subscribe(store, `${synthName}.filter.range`, synth.setFilterRange);\n  subscribe(store, `${synthName}.filter.q`, synth.setFilterQ);\n}\n\nexport function subscribeLennySynth(store, synth) {\n  const synthName = synth.name;\n  subscribe(store, `${synthName}.reverb`, synth.setReverb);\n  subscribe(store, `${synthName}.length`, synth.setLength);\n  subscribe(store, `${synthName}.phaser`, synth.setPhaser);\n  subscribe(store, `${synthName}.vibratoDepth`, synth.setVibratoDepth);\n}\n\nexport function subscribeDrummer(store, synth) {\n  const synthName = synth.name;\n  subscribe(store, `${synthName}.filterFreq`, synth.setFilterFreq);\n  subscribe(store, `${synthName}.delay`, synth.setDelay);\n}\n\n\n/**\n * TODO: Remove frequency information from composition and get \n * frequencies from key number so that notes/scales can be changed\n */\n\nexport function subscribeSequencer(store, sequencer) {\n  // subscribe each sequence to it's corresponding composition in the redux store\n  for (const [synthName, sequence] of Object.entries(sequencer.sequences)) {\n    const { composition } = store.getState()[synthName];\n    // subscribe to each cell in the matrix\n    for (const [rowi, row] of composition.entries()) {\n      for (const [coli, cell] of row.entries()) {\n        const path = String.raw`${synthName}.composition.${rowi}.${coli}.active`;\n        subscribe(store, path, active => {\n          const freq = synthName === 'drummer' ? String(cell.keyIndex) : cell.note.frequency;\n          if (active) {\n            sequence.addNote({ index: coli, freq });\n          } else {\n            sequence.removeNote({ index: coli, freq });\n          }\n        });\n      }\n    }\n  }\n}","import { createSlice } from 'redux-starter-kit';\n\nconst MAX = 20;\n\nconst setNumActive = (state, action) => {\n  const { active } = action.payload;\n  if (active) {\n    state.numActive += 1;\n  } else {\n    state.numActive -= 1;\n  }\n  if (state.numActive >= MAX) {\n    state.maxReached = true;\n  } else {\n    state.maxReached = false;\n  }\n}\n\nconst utilSlice = createSlice({\n  initialState: {\n    message: 'Hello, World',\n    startTime: null,\n    nextInterval: 0,\n    numActive: 0,\n    maxReached: false,\n    countDown: null,\n  },\n  reducers: {\n    setMessage(state, action) {\n      console.log('change to ', action.payload);\n      state.message = action.payload;\n    },\n    setStartTime(state, action) {\n      state.startTime = action.payload;\n    },\n    setNextInterval(state, action) {\n      state.nextInterval = action.payload;\n    },\n    setCountDown(state, action) {\n      state.countDown = action.payload;\n    }\n  },\n  extraReducers: {\n    'bass/setCompositionCell': setNumActive,\n    'lenny/setCompositionCell': setNumActive,\n    'drummer/setCompositionCell': setNumActive,\n  }\n});\n\nexport const {\n  setMessage,\n  setStartTime,\n  setNextInterval,\n  setCountDown,\n} = utilSlice.actions;\nexport default utilSlice.reducer;","import { createSlice } from 'redux-starter-kit';\n\nconst characterSlice = createSlice({\n  initialState: {\n    character: null,\n  },\n  reducers: {\n    setCharacter(state, action) {\n      state.character = action.payload.character;\n    }\n  }\n});\n\nexport const { setCharacter } = characterSlice.actions;\nexport default characterSlice.reducer;","import { configureStore, getDefaultMiddleware } from 'redux-starter-kit';\nimport synth1Reducer from './reducers/synth1Reducer';\nimport bassReducer from '../BassSynth/bassReducer';\nimport lennyReducer from '../LennySynth/lennyReducer'\nimport drummerReducer from '../Drummer/drummerReducer';\nimport utilReducer from './reducers/utilReducer';\nimport characterReducer from './reducers/characterReducer';\n\nconst makeStore = (middleware = [], initialState) => {\n  return configureStore({\n    reducer: {\n      synth1: synth1Reducer,\n      bass: bassReducer,\n      lenny: lennyReducer,\n      drummer: drummerReducer,\n      util: utilReducer,\n      character: characterReducer,\n    },\n    middleware: [...getDefaultMiddleware(), ...middleware],\n    ...initialState && { preloadedState: initialState }\n  });\n};\n\nexport default makeStore;","import io from 'socket.io-client';\nimport makeStore from '../redux/store';\nimport { setCharacter } from '../redux/reducers/characterReducer';\nimport { setCountDown } from '../redux/reducers/utilReducer';\n\nconst blackList = [\n  'setCharacter',\n  'setNextInterval',\n  'setCountDown'\n]\n\nconst charOverride = process.env.REACT_APP_CHAR;\n\nconst makeActionEmitter = socket => store => next => action => {\n  const result = next(action);\n  if (!(blackList.includes(action.type)) && !action.origin) {\n    socket.emit('action', { ...action, origin: socket.id });\n  }\n  return result;\n}\n\nexport const makeStoreWithSocket = async () => {\n  const socket = io(process.env.REACT_APP_SERVER_URI, { transports: ['websocket'] });\n\n  let character;\n  // wait for initial state from server before creating store\n  const initialState = await new Promise(resolve => {\n    socket.on('init', config => {\n      console.log(config);\n      console.log('You are player ', config.character);\n      character = charOverride ? charOverride : config.character;\n      resolve(config.state);\n    });\n  });\n\n  const actionEmitter = makeActionEmitter(socket);\n  const store = makeStore([actionEmitter], initialState);\n\n  store.dispatch(setCharacter({ character }));\n\n  socket.on('action', action => {\n    store.dispatch(action);\n  });\n\n  socket.on('GET_STATE', (_, cb) => {\n    const { character, ...rest } = store.getState();\n    cb(rest);\n  });\n\n  !charOverride &&\n  socket.on('CHARACTER_CHANGE', ({ charactersById }) => {\n    const character = charactersById[socket.id];\n    const countDown = (count) => {\n      setTimeout(() => {\n        if (count >= 0) {\n            store.dispatch(setCountDown(count));\n            if (count === 0) {\n              store.dispatch(setCountDown('Swap!'))\n              store.dispatch(setCharacter({ character }))\n            }\n            countDown(count - 1);\n        } else {\n          store.dispatch(setCountDown(null))\n        }\n      }, 1000);\n    }\n    countDown(5);\n  });\n\n  return store;\n}\n","export default class Sequence {\n\n  chords = []\n  synth = null;\n  frequencyOffset = 0;\n\n  constructor(synth, numSteps) {\n    this.synth = synth;\n    this.chords = new Array(numSteps)\n      .fill(null).map(v => []);\n  }\n\n  getNotes(step) {\n    return this.chords[step] || [];\n    // let chord = this.chords[step] || [];\n    // return chord.map(note => note + this.frequencyOffset * 10);;\n  }\n\n  addNote = ({ index, freq }) => {\n    const chord = this.chords[index];\n    if (!chord.includes(freq)) {\n      chord.push(freq);\n    }\n  }\n\n  removeNote = ({ index, freq }) => {\n    this.chords[index] = this.chords[index].filter(value => value !== freq);\n  }\n\n}","import Tone from 'tone';\nimport Sequence from './Sequence';\n\nexport default class Sequencer {\n\n  step = 0;\n  numSteps = 0;\n  onTick = null;\n  loop = null;\n  sequences = {};\n\n  constructor({ bpm, numSteps }) {\n    this.numSteps = numSteps;\n    Tone.Transport.bpm.value = bpm;\n    Tone.Transport.start('+0.1');\n\n    this.loop = new Tone.Loop(this._loopCallback, '16n');\n    this.loop.humanize = true;\n  }\n\n  _loopCallback = (time) => {\n    // UI callback\n    this._onTick(time, this.step);\n    // trigger notes for each sequence\n    for (const seq of Object.values(this.sequences)) {\n      const nextChord = seq.getNotes(this.step)\n      nextChord.length > 0 &&\n        seq.synth.triggerAttackRelease(nextChord, '16n', time);\n    }\n    this.step++;\n    if (this.step >= this.numSteps) this.step = 0;\n  }\n\n  _onTick(time, step) {\n    if (step === 0 && this.onLoop) {\n      Tone.Draw.schedule(() => {\n        this.onLoop(Date.now());\n      }, time);\n    }\n    if (this.onTick) {\n      Tone.Draw.schedule(() => {\n        this.onTick(step);\n      }, time)\n    }\n  }\n\n  createSequence = (synth) => {\n    this.sequences[synth.name] = new Sequence(synth, this.numSteps);\n  }\n\n  start = () => {\n    Tone.context.resume();\n    this.loop.start();\n  }\n\n  stop = () => {\n    this.loop.stop();\n    this.step = 0;\n  }\n}","\nexport const mapRange = (x, in_min, in_max, out_min, out_max) => {\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nexport const mapRatioToRange = (x, out_min, out_max) => {\n  const in_min = 0;\n  const in_max = 1;\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\n","import Tone from 'tone';\nimport {mapRange} from '../util/util';\n\nexport default class LennySynthAudio {\n  name = null;\n  constructor(name) {\n    if (!name) {\n      throw new Error('CSynth constructor requires a name');\n    }\n    this.name = name;\n\n    this.reverb = new Tone.Freeverb();\n    this.vibrato = new Tone.Vibrato();\n    this.phaser = new Tone.Phaser({\n      frequency: 0.4,\n      octaves: 2,\n      baseFrequency: 200,\n      Q: 18,\n      stages: 20,\n    });\n    this.phaser.wet.value = 1;\n    this.synth = new Tone.PolySynth(6, Tone.MonoSynth)\n      .chain(\n        this.vibrato,\n        this.reverb,\n        this.phaser,\n        new Tone.Limiter(),\n        Tone.Master\n      );\n    this.synth.set({\n      volume: -12,\n      detune: -1200,\n      oscillator: {\n        type: 'triangle'\n      },\n      filterEnvelope: {\n        attack: 0.01,\n        decay: 1,\n        sustain: 1,\n      },\n      filter: {\n        Q: 0\n      }\n    });\n  }\n\n  triggerAttackRelease = (notes, length, time) => {\n    this.synth.triggerAttackRelease(notes, length, time);\n  }\n\n  setReverb = ratio => {\n    // this.reverb.decay = ratio * 8;\n    // this.reverb.wet.value = mapRange(ratio, 0, 1, 0.0, 0.9);\n    this.reverb.roomSize.value = mapRange(ratio, 0, 1, 0.2, 1);\n  }\n\n  setLength = ratio => {\n    this.synth.set({\n      envelope: {\n        release: (ratio * 8) + 0.01\n      },\n      filterEnvelope: {\n        release: (ratio * 80) + 0.01\n      }\n    });\n  }\n\n  setPhaser = state => {\n    if (state) {\n      this.phaser.wet.value = 1\n    } else {\n      this.phaser.wet.value = 0\n    }\n  }\n\n  setVibratoDepth = ratio => {\n    this.vibrato.depth.value = ratio;\n  }\n}\n","import Tone from 'tone';\n// import { notes } from '../redux/config-creators/compositionReducerConfig';\nimport { mapRatioToRange } from '../util/util'\nimport { clamp } from 'lodash';\n\nexport default class DrummerAudio {\n  constructor(name, files) {\n    this.name = name;\n    // set up audio files\n    this.urls = files.reduce((acc, file) => {\n      acc[file.index] = file.path\n      return acc;\n    }, {})\n    // setup effects\n    this.filter = new Tone.Filter();\n    this.delay = new Tone.FeedbackDelay('8n', 0.5)\n\n    // create sampler\n    this.synth = new Tone.Players(this.urls)\n      .chain(\n        this.filter,\n        this.delay,\n        new Tone.Volume(-8),\n        new Tone.Limiter(),\n        Tone.Master\n      );\n  }\n\n  triggerAttackRelease = (notes, length, time) => {\n    // this.synth.triggerAttackRelease(notes, length, time);\n    notes.forEach(note => {\n      if (!this.urls[note]) return;\n      this.synth.get(note).restart(time);\n      this.synth.get(note).start(time);\n    });\n  }\n\n  setFilterFreq = ratio => {\n    // this.filter\n    this.filter.frequency.value = mapRatioToRange(Math.pow(ratio, 2), 0, 10000);\n  }\n\n  setDelay = ratio => {\n    this.delay.feedback.value = mapRatioToRange(ratio, 0.2, 0.5);\n    this.delay.wet.value = clamp(ratio - 0.2, 0, 1);\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport Tone from 'tone';\nimport { Provider } from 'react-redux';\nimport startAudioContext from 'startaudiocontext';\nimport CSynth from './audio/CSynth';\nimport BassSynthAudio from './BassSynth/BassSynthAudio';\nimport {\n  subscribeCSynth,\n  subscribeBassSynth,\n  subscribeSequencer,\n  subscribeLennySynth,\n  subscribeDrummer\n} from './redux/subscriptions'\nimport { numSteps } from './redux/config-creators/compositionReducerConfig';\nimport { setNextInterval } from './redux/reducers/utilReducer';\nimport { makeStoreWithSocket } from './socket/configureSocket';\nimport Sequencer from './audio/Sequencer';\nimport LennySynthAudio from './LennySynth/LennySynthAudio';\nimport DrummerAudio from './Drummer/DrummerAudio';\n\n\nconst bpm = 85;\nexport const sequencer = new Sequencer({ bpm, numSteps });\nconst oneMinute = 60000\nconst oneBeat = oneMinute / bpm\nconst intervalTime = oneBeat * numSteps;\n\n(async () => {\n\n  // setup web sockets to listen for and emit redux actions\n  // need to wait for initial state before creating the store\n  const store = await makeStoreWithSocket();\n\n  sequencer.onLoop = time => {\n    store.dispatch(setNextInterval(time + intervalTime));\n  }\n\n  const synth1 = new CSynth('synth1');\n  const bass = new BassSynthAudio('bass');\n  const lenny = new LennySynthAudio('lenny');\n  const drummer = new DrummerAudio('drummer', store.getState().drummer.files);\n\n  sequencer.createSequence(synth1);\n  sequencer.createSequence(bass);\n  sequencer.createSequence(lenny);\n  sequencer.createSequence(drummer);\n\n  subscribeCSynth(store, synth1);\n  subscribeBassSynth(store, bass);\n  subscribeLennySynth(store, lenny);\n  subscribeDrummer(store, drummer);\n\n  subscribeSequencer(store, sequencer);\n\n  // click needed to start audio context\n  document.getElementById('start-message').innerHTML = \"Please Click To Continue\"\n\n  // wait for audio context to start before rendering\n  await startAudioContext(Tone.context);\n\n  // find next interval to start at\n  const { nextInterval } = store.getState().util;\n  console.log(nextInterval)\n  if (nextInterval === 0) {\n    sequencer.start();\n  } else {\n    setTimeout(() => {\n      sequencer.start();\n    }, store.getState().util.nextInterval - Date.now())\n  }\n\n  // sequencer.start();\n\n  ReactDOM.render((\n    <Provider store={store}>\n      <App />\n    </Provider>\n  ), document.getElementById('root'));\n\n})();","module.exports = __webpack_public_path__ + \"static/media/kick_02.f5e08c6e.wav\";","module.exports = __webpack_public_path__ + \"static/media/snare_01.16f25651.wav\";","module.exports = __webpack_public_path__ + \"static/media/rim_01.2369df53.wav\";","module.exports = __webpack_public_path__ + \"static/media/shaker_snap_01.689d3025.wav\";","module.exports = __webpack_public_path__ + \"static/media/clap_01.f1089572.wav\";","module.exports = __webpack_public_path__ + \"static/media/short_cymbal_01.b55be721.wav\";","module.exports = __webpack_public_path__ + \"static/media/long_cymbal_01.7a357bf3.wav\";"],"sourceRoot":""}