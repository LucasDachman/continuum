(window["webpackJsonpcontinuum-client"]=window["webpackJsonpcontinuum-client"]||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var r=n(14),a=n.n(r),c=n(23),i=n(0),o=n.n(i),s=n(21),l=n.n(s),u=n(6),h=n(4),f=n(2),p=n(3),y=n(1),m=n.n(y);function b(e){return"black"===e.color}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127;if(!(e<0||t>127)){var n=new Array(t-e).fill(0).map(function(t,n){return n+e});return n=n.map(function(e){var t=m.a.Frequency(e,"midi"),n=t.toNote();return{name:n,frequency:t.toFrequency(),color:n.includes("#")?"black":"white"}})}console.error("note out of range")}(36,60),g=function(){return{initialState:new Array(24).fill(null).map(function(e,t){return new Array(16).fill(null).map(function(){return{active:!1,note:v[t]}})}),reducers:{setCompositionCell:function(e,t){var n=t.payload,r=n.row,a=n.col,c=n.active;e.composition[r][a].active=c},toggleCompositionCell:function(e,t){var n=t.payload,r=n.row,a=n.col;e.composition[r][a].active=!e.composition[r][a].active}}}};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var d=g(),j=Object(p.b)({slice:"synth1",initialState:{amp:{attack:0,decay:.5,sustain:1,release:.2},filter:{attack:0,decay:.5,sustain:1,release:.2,base:0,range:.5,q:0},composition:d.initialState},reducers:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){Object(h.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({setAmp:function(e,t){for(var n=0,r=Object.entries(t.payload);n<r.length;n++){var a=r[n],c=Object(u.a)(a,2),i=c[0],o=c[1];e.amp[i]=o}},setFilter:function(e,t){for(var n=0,r=Object.entries(t.payload);n<r.length;n++){var a=r[n],c=Object(u.a)(a,2),i=c[0],o=c[1];e.filter[i]=o}}},d.reducers)}),w=j.actions,E=w.setAmp,k=w.setFilter,S=w.setCompositionCell,C=w.toggleCompositionCell,P=j.reducer,F=n(8),D=Object(i.memo)(function(e){var t=e.value,n=e.onChange,r=e.children;return o.a.createElement("div",{className:"knob"},o.a.createElement("div",null,o.a.createElement(F.CircularInput,{radius:18,value:t,onChange:n},o.a.createElement(F.CircularTrack,{strokeWidth:8}),o.a.createElement(F.CircularProgress,{strokeWidth:8}),o.a.createElement(F.CircularThumb,{r:"6"}))),o.a.createElement("div",{style:{zIndex:-1}},r))}),R={setAmp:E,setFilter:k},A=function(e,t){return Object(i.useCallback)(function(n){return e(Object(h.a)({},t,n))},[e,t])},q=Object(f.b)(function(e){return{amp:e.synth1.amp,filter:e.synth1.filter}},R)(function(e){var t=e.setAmp,n=e.setFilter,r=e.amp,a=e.filter;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Synth 1"),o.a.createElement("div",{className:"synth-1 synth"},o.a.createElement("section",{id:"amp-env"},o.a.createElement("div",{className:"knob-row knob-row-vertical"},o.a.createElement("h4",null,"Amp"),o.a.createElement(D,{value:r.attack,onChange:A(t,"attack")},"Attack"),o.a.createElement(D,{value:r.decay,onChange:A(t,"decay")},"Decay"),o.a.createElement(D,{value:r.sustain,onChange:A(t,"sustain")},"Sustain"),o.a.createElement(D,{value:r.release,onChange:A(t,"release")},"Release"))),o.a.createElement("section",{id:"filter-env"},o.a.createElement("div",{className:"knob-row knob-row-vertical"},o.a.createElement("h4",null,"Filter"),o.a.createElement(D,{value:a.attack,onChange:A(n,"attack")},"Attack"),o.a.createElement(D,{value:a.decay,onChange:A(n,"decay")},"Decay"),o.a.createElement(D,{value:a.sustain,onChange:A(n,"sustain")},"Sustain"),o.a.createElement(D,{value:a.release,onChange:A(n,"release")},"Release")),o.a.createElement("div",{className:"knob-row knob-row-vertical"},o.a.createElement(D,{value:a.base,onChange:A(n,"base")},"Base"),o.a.createElement(D,{value:a.range,onChange:A(n,"range")},"Range"),o.a.createElement(D,{value:a.q,onChange:A(n,"q")},"Q")))))});function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var x=g(),Q=Object(p.b)({slice:"bass",initialState:{length:.07,shape:0,filter:{decay:.5,range:.3769,q:.1},composition:x.initialState},reducers:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){Object(h.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},x.reducers,{setLength:function(e,t){e.length=t.payload},setShape:function(e,t){e.shape=t.payload},setFilterDecay:function(e,t){e.filter.decay=t.payload},setFilterRange:function(e,t){e.filter.range=t.payload},setFilterQ:function(e,t){e.filter.q=t.payload}})}),T=Q.actions,L=T.setCompositionCell,M=T.toggleCompositionCell,B=T.setLength,_=T.setShape,z=T.setFilterDecay,I=T.setFilterRange,W=T.setFilterQ,H=Q.reducer,J={setCompositionCell:L,setLength:B,setShape:_,setFilterDecay:z,setFilterRange:I,setFilterQ:W},Y=Object(f.b)(function(e){return{length:e.bass.length,shape:e.bass.shape,filterDecay:e.bass.filter.decay,filterRange:e.bass.filter.range,filterQ:e.bass.filter.q}},J)(function(e){var t=e.setLength,n=e.setShape,r=e.setFilterDecay,a=e.setFilterRange,c=e.setFilterQ,i=e.length,s=e.shape,l=e.filterDecay,u=e.filterRange,h=e.filterQ;return o.a.createElement("div",{className:"bass-synth synth"},o.a.createElement("h2",null,"Bass Synth"),o.a.createElement("div",{className:"knob-row knob-row-horizontal"},o.a.createElement(D,{value:i,onChange:t},"Length"),o.a.createElement(D,{value:s,onChange:n},"Shape"),o.a.createElement(D,{value:l,onChange:r},"Decay"),o.a.createElement(D,{value:u,onChange:a},"Brightness"),o.a.createElement(D,{value:h,onChange:c},"Harshness")))});function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var K=g(),U=Object(p.b)({slice:"lenny",initialState:{reverb:0,composition:K.initialState},reducers:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(n,!0).forEach(function(t){Object(h.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},K.reducers,{setReverb:function(e,t){e.reverb=t.payload}})}),V=U.actions,X=(V.setCompositionCell,V.toggleCompositionCell),Z=V.setReverb,$=U.reducer,ee=n(56),te=n.n(ee),ne={synth1:C,bass:M,lenny:X},re=Object(i.memo)(function(e){var t=e.row,n=e.col,r=Object(f.c)(),a=Object(f.d)(function(e){return e.character.character}),c=Object(i.useCallback)(function(e){e.stopPropagation(),r(ne[a]({row:t,col:n}))},[t,n,a,r]),s={synth1:Object(f.d)(function(e){return e.synth1.composition[t][n]}),bass:Object(f.d)(function(e){return e.bass.composition[t][n]}),lenny:Object(f.d)(function(e){return e.lenny.composition[t][n]})},l=["piano-cell",b(s[a].note)?"black":"white"].join(" ");return o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:l,onClick:c},te.a.map(s,function(e,t){return e.active&&o.a.createElement("span",{key:t,onClick:c,className:"cell-trigger cell-trigger-".concat(t)})})))}),ae=(n(75),{setCompositionCell:S}),ce=Object(f.b)(function(e){return{composition:e.synth1.composition}},ae)(function(e){e.activeColumn;var t=e.composition;return o.a.createElement("div",{className:"piano-roll"},o.a.createElement("section",{className:"piano-roll-keys"},v.map(function(e){var t=["piano-key",b(e)?"black":"white"].join(" ");return o.a.createElement("div",{className:t,key:e.name},o.a.createElement("p",null,e.name))})),o.a.createElement("section",{className:"piano-roll-editor"},v.map(function(e,n){return o.a.createElement("section",{key:n,className:"step-row ".concat(b(e)?"black":"white")},t[n].map(function(e,t){return o.a.createElement(re,{key:"".concat(n,", ").concat(t),row:n,col:t})}))})))}),ie=n(57),oe=n.n(ie),se=(n(76),{setReverb:Z}),le=Object(f.b)(function(e){return{reverb:e.lenny.reverb}},se)(function(e){var t=e.reverb,n=e.setReverb;return o.a.createElement("div",{className:"lenny-synth synth"},o.a.createElement("h2",null,"Lenny"),o.a.createElement("div",{className:"knob-row knob-row-horizontal"},o.a.createElement(D,{value:t,onChange:n},"Reverb")))}),ue=Object(f.b)(function(e){return{character:e.character.character}},null)(function(e){var t=e.character,n=Object(i.useState)(!1),r=Object(u.a)(n,2),a=r[0],c=r[1],s=Object(i.useState)(!1),l=Object(u.a)(s,2),h=l[0],f=l[1],p=Object(i.useState)(0),y=Object(u.a)(p,2),b=y[0],v=y[1];return Object(i.useEffect)(function(){oe()(m.a.context).then(function(){f(!0)}),He.onTick=function(e){v(e)}},[]),Object(i.useEffect)(function(){a?He.start():He.stop()},[a]),h?o.a.createElement("main",null,o.a.createElement("section",{id:"control-panel"},o.a.createElement("p",null,"You are: ",t),o.a.createElement("button",{id:"play-button",onClick:function(){m.a.context.resume(),c(!a)}},a?"Stop":"Play")),o.a.createElement(q,null),o.a.createElement(Y,null),o.a.createElement(le,null),o.a.createElement("section",{id:"sequencer"},o.a.createElement(ce,{currentStep:b}))):"Click"}),he=n(7),fe=n(58),pe=n(59),ye=n.n(pe),me=n(31);function be(){var e=Object(fe.a)(["",".composition.",".",".active"]);return be=function(){return e},e}var ve=function(e,t,n){e.subscribe(ye()(e.getState,t)(n)),n(Object(me.get)(e.getState(),t))};function ge(e,t){var n=t.name;ve(e,"".concat(n,".amp.attack"),t.setAmpAttack),ve(e,"".concat(n,".amp.decay"),t.setAmpDecay),ve(e,"".concat(n,".amp.sustain"),t.setAmpSustain),ve(e,"".concat(n,".amp.release"),t.setAmpRelease),ve(e,"".concat(n,".filter.attack"),t.setFilterAttack),ve(e,"".concat(n,".filter.decay"),t.setFilterDecay),ve(e,"".concat(n,".filter.sustain"),t.setFilterSustain),ve(e,"".concat(n,".filter.release"),t.setFilterRelease),ve(e,"".concat(n,".filter.base"),t.setFilterBase),ve(e,"".concat(n,".filter.range"),t.setFilterRange),ve(e,"".concat(n,".filter.q"),t.setFilterQ)}function Oe(e,t){var n=t.name;ve(e,"".concat(n,".length"),t.setLength),ve(e,"".concat(n,".shape"),t.setShape),ve(e,"".concat(n,".filter.decay"),t.setFilterDecay),ve(e,"".concat(n,".filter.range"),t.setFilterRange),ve(e,"".concat(n,".filter.q"),t.setFilterQ)}function de(e,t){var n=t.name;ve(e,"".concat(n,".reverb"),t.setReverb)}function je(e,t){for(var n=function(){var t=a[r],n=(c=Object(u.a)(t,2))[0],i=c[1],o=e.getState()[n].composition,s=!0,l=!1,h=void 0;try{for(var f,p=o.entries()[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var y=f.value,m=Object(u.a)(y,2),b=m[0],v=m[1],g=!0,O=!1,d=void 0;try{for(var j,w=function(){var t=j.value,r=(k=Object(u.a)(t,2))[0],a=k[1],c=String.raw(be(),n,b,r);ve(e,c,function(e){e?i.addNote({index:r,freq:a.note.frequency}):i.removeNote({index:r,freq:a.note.frequency})})},E=v.entries()[Symbol.iterator]();!(g=(j=E.next()).done);g=!0){var k;w()}}catch(S){O=!0,d=S}finally{try{g||null==E.return||E.return()}finally{if(O)throw d}}}}catch(S){l=!0,h=S}finally{try{s||null==p.return||p.return()}finally{if(l)throw h}}},r=0,a=Object.entries(t.sequences);r<a.length;r++){var c;n()}}var we=n(60),Ee=n(61),ke=n.n(Ee),Se=n(34),Ce=Object(p.b)({initialState:{message:"Hello, World"},reducers:{setMessage:function(e,t){console.log("change to ",t.payload),e.message=t.payload}}}),Pe=(Ce.actions.setMessage,Ce.reducer),Fe=Object(p.b)({initialState:{character:null},reducers:{setCharacter:function(e,t){e.character=t.payload.character}}}),De=Fe.actions.setCharacter,Re=Fe.reducer;function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach(function(t){Object(h.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return Object(p.a)(qe({reducer:{synth1:P,bass:H,lenny:$,util:Pe,character:Re},middleware:[].concat(Object(Se.a)(Object(p.c)()),Object(Se.a)(e))},t&&{preloadedState:t}))};function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Qe=["setCharacter"],Te=function(e){return function(t){return function(t){return function(n){var r=t(n);return Qe.includes(n.type)||n.origin||e.emit("action",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(n,!0).forEach(function(t){Object(h.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{origin:e.id})),r}}}},Le=function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r,c,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=ke()("https://continuum-7.appspot.com",{transports:["websocket"]}),e.next=3,new Promise(function(e){t.on("init",function(t){console.log(t),console.log("You are player ",t.character),n=t.character,e(t.state)})});case 3:return r=e.sent,c=Te(t),(i=Ne([c],r)).dispatch(De({character:n})),t.on("action",function(e){i.dispatch(e)}),t.on("GET_STATE",function(e,t){var n=i.getState();n.character;t(Object(we.a)(n,["character"]))}),e.abrupt("return",i);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Me=n(24),Be=function(){function e(t,n){var r=this;Object(he.a)(this,e),this.chords=[],this.synth=null,this.frequencyOffset=0,this.addNote=function(e){var t=e.index,n=e.freq,a=r.chords[t];a.includes(n)||a.push(n)},this.removeNote=function(e){var t=e.index,n=e.freq;r.chords[t]=r.chords[t].filter(function(e){return e!==n})},this.synth=t,this.chords=new Array(n).fill(null).map(function(e){return[]})}return Object(Me.a)(e,[{key:"getNotes",value:function(e){var t=this;return(this.chords[e]||[]).map(function(e){return e+10*t.frequencyOffset})}}]),e}(),_e=function(){function e(t){var n=this,r=t.bpm,a=t.numSteps;Object(he.a)(this,e),this.step=0,this.numSteps=0,this.onTick=null,this.loop=null,this.sequences={},this._loopCallback=function(e){n._onTick(e,n.step);for(var t=0,r=Object.values(n.sequences);t<r.length;t++){var a=r[t],c=a.getNotes(n.step);c.length>0&&a.synth.triggerAttackRelease(c,"16n",e)}n.step++,n.step>=n.numSteps&&(n.step=0)},this.createSequence=function(e){n.sequences[e.name]=new Be(e,n.numSteps)},this.start=function(){m.a.context.resume(),n.loop.start()},this.stop=function(){n.loop.stop(),n.step=0},this.numSteps=a,m.a.Transport.bpm.value=r,m.a.Transport.start(),this.loop=new m.a.Loop(this._loopCallback,"16n")}return Object(Me.a)(e,[{key:"_onTick",value:function(e,t){var n=this;this.onTick&&m.a.Draw.schedule(function(){n.onTick(t)},e+.1)}}]),e}();n.d(t,"sequencer",function(){return He});var ze=new function e(t){var n=this;if(Object(he.a)(this,e),this.name=null,this.triggerAttack=function(e){n.synth.triggerAttack(e)},this.triggerRelease=function(e){n.synth.triggerRelease(e)},this.triggerAttackRelease=function(e,t,r){n.synth.triggerAttackRelease(e,t,r)},this.setAmpAttack=function(e){n.synth.set({envelope:{attack:e+.01}})},this.setAmpDecay=function(e){n.synth.set({envelope:{decay:e+.01}})},this.setAmpSustain=function(e){n.synth.set({envelope:{sustain:e}})},this.setAmpRelease=function(e){n.synth.set({envelope:{release:10*e+.01}})},this.setFilterAttack=function(e){n.synth.set({filterEnvelope:{attack:e/5+.01}})},this.setFilterDecay=function(e){n.synth.set({filterEnvelope:{decay:e+.01}})},this.setFilterSustain=function(e){n.synth.set({filterEnvelope:{sustain:e}})},this.setFilterRelease=function(e){n.synth.set({filterEnvelope:{release:100*e+.01}})},this.setFilterBase=function(e){n.synth.set({filterEnvelope:{baseFrequency:500*e+1}})},this.setFilterRange=function(e){n.synth.set({filterEnvelope:{octaves:20*e}})},this.setFilterQ=function(e){n.synth.set({filter:{Q:10*e}})},!t)throw new Error("CSynth constructor requires a name");this.name=t,this.synth=new m.a.PolySynth(6,m.a.MonoSynth).chain(new m.a.Limiter,m.a.Master),this.synth.set({volume:-12,oscillator:{type:"sawtooth"}})}("synth1"),Ie=new function e(t){var n=this;if(Object(he.a)(this,e),this.name=null,this.triggerAttack=function(e){n.synth.triggerAttack(e)},this.triggerRelease=function(e){n.synth.triggerRelease(e)},this.triggerAttackRelease=function(e,t,r){n.synth.triggerAttackRelease(e,t,r)},this.setLength=function(e){n.synth.set({envelope:{release:10*e+.01},filterEnvelope:{release:100*e+.01}})},this.setShape=function(e){n.synth.set({filterEnvelope:{attack:e/5+.01}})},this.setFilterDecay=function(e){n.synth.set({filterEnvelope:{decay:e+.01}})},this.setFilterRange=function(e){n.synth.set({filterEnvelope:{octaves:20*e}})},this.setFilterQ=function(e){n.synth.set({filter:{Q:10*e}})},!t)throw new Error("CSynth constructor requires a name");this.name=t,this.synth=new m.a.PolySynth(1,m.a.MonoSynth).chain(new m.a.Limiter,m.a.Master),this.synth.set({volume:-12,detune:-1200,oscillator:{type:"sawtooth"},envelope:{attack:.01,sustain:1,decay:.05},filter:{baseFrequency:6},filterEnvelope:{sustain:.47415415352178325}})}("bass"),We=new function e(t){var n=this;if(Object(he.a)(this,e),this.name=null,this.triggerAttackRelease=function(e,t,r){n.synth.triggerAttackRelease(e,t,r)},this.setReverb=function(e){n.reverb.wet.value=e},!t)throw new Error("CSynth constructor requires a name");this.name=t,this.reverb=new m.a.Reverb,this.reverb.decay=8,this.reverb.generate(),this.synth=new m.a.PolySynth(6,m.a.MonoSynth).chain(this.reverb,new m.a.Limiter,m.a.Master),this.synth.set({volume:-12,detune:1200,oscillator:{type:"triangle"},filterEnvelope:{attack:.01,decay:1,sustain:1},filter:{Q:0}})}("lenny"),He=new _e({bpm:170,numSteps:16});He.createSequence(ze),He.createSequence(Ie),He.createSequence(We),Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le();case 2:ge(t=e.sent,ze),Oe(t,Ie),de(t,We),je(t,He),l.a.render(o.a.createElement(f.a,{store:t},o.a.createElement(ue,null)),document.getElementById("root"));case 8:case"end":return e.stop()}},e)}))()},63:function(e,t,n){e.exports=n(102)},75:function(e,t,n){},76:function(e,t,n){},99:function(e,t){}},[[63,1,2]]]);
//# sourceMappingURL=main.c87c9aaa.chunk.js.map